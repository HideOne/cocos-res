# Cocos Creator JSON 转 Plist 工具 - 使用说明

## 问题解决

✅ **已修复**：脚本现在可以正确解析 Cocos Creator JSON 格式并生成标准的 plist 文件。

## 快速使用

### 方法 1：命令行直接使用（推荐）

```bash
# 转换单个文件
node json-to-plist-converter.js <输入JSON文件> <输出plist文件>

# 示例
node json-to-plist-converter.js "D:\work\test\fnt\build\web-mobile\assets\resources\import\0f\0faa447ee.json" "D:\work\test\fnt\assets\resources\pic\hetu.plist"
```

### 方法 2：在代码中调用

在你的 TypeScript 或 JavaScript 文件中：

```typescript
import { convertJSONToPlist } from "./json-to-plist-converter";

// 转换单个文件
convertJSONToPlist(
    "源JSON文件路径",
    "目标plist文件路径"
);

// 批量转换目录
import { convertDirectory } from "./json-to-plist-converter";
convertDirectory(
    "输入目录",
    "输出目录"
);
```

### 方法 3：批量转换

```bash
# 批量转换整个目录
node json-to-plist-converter.js <输入目录> --dir <输出目录>

# 示例
node json-to-plist-converter.js "d:\suyu\cocosRes\activity-album\import\01" --dir "d:\suyu\cocosRes\activity-album\output"
```

## 转换效果验证

生成的 plist 文件将包含：

✅ 所有精灵帧的完整信息（位置、尺寸、偏移）
✅ 正确的纹理文件名
✅ 准确的图集尺寸
✅ 标准的 Apple Property List XML 格式

## 示例输出

```
Reading JSON file: D:\work\test\fnt\build\web-mobile\assets\resources\import\0f\0faa447ee.json
Parsing Cocos Creator JSON format...
Generating plist XML...
✓ Successfully converted to: D:\work\test\fnt\assets\resources\pic\hetu.plist
  Found 5 frames
  Texture: hetu.png
  Size: 319x131
```

## 生成的文件格式

生成的 plist 文件与原始的 Cocos Creator 导出的 plist 格式完全一致，包含：

- `frames` 字典：所有精灵帧的详细信息
  - 每个帧的名称、位置、尺寸、偏移量
  - 是否旋转的标记
- `metadata` 元数据：
  - 纹理文件名
  - 图集总尺寸
  - 格式版本等信息

## 支持的输入格式

脚本支持 Cocos Creator 编译后的 JSON 图集文件，通常位于：
```
build/web-mobile/assets/resources/import/*/*.json
```

这些文件包含了 `SpriteAtlas` 和 `SpriteFrame` 的序列化数据。

## 注意事项

1. 确保输入文件是有效的 Cocos Creator JSON 格式
2. 输出目录会自动创建（如果不存在）
3. 如果输出文件已存在会被覆盖
4. 生成的帧名称会自动添加 `.png` 后缀

## 常见问题

**Q：生成的 plist 文件为什么没有帧信息？**  
A：确保你使用的是最新编译的脚本。运行 `npx tsc json-to-plist-converter.ts` 重新编译。

**Q：可以批量处理多个文件吗？**  
A：可以，使用 `--dir` 参数批量转换整个目录。

**Q：生成的文件能直接在其他工具中使用吗？**  
A：可以，生成的是标准的 Apple Property List 格式，兼容 TexturePacker 等工具。

## 技术支持

如有问题：
1. 检查 Node.js 版本 >= 14.0.0
2. 确保输入 JSON 文件格式正确
3. 查看控制台输出的详细信息
4. 参考 `README-converter.md` 获取更多详细文档
